<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2D Doom-Game Mobile</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      height: 100vh;
    }

    #gameCanvas {
      display: block;
      margin: auto;
      border: 2px solid #fff;
      width: 100%;
      height: 70%;
    }

    .controls {
      display: flex;
      justify-content: center;
      margin-top: 10px;
    }

    .controls button {
      background-color: #444;
      color: #fff;
      border: none;
      padding: 15px 20px;
      margin: 5px;
      font-size: 18px;
      border-radius: 5px;
      cursor: pointer;
    }

    .controls button:active {
      background-color: #777;
    }

    .shoot-btn {
      background-color: red;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 24px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      margin-left: 10px;
    }

    .shoot-btn:active {
      background-color: darkred;
    }

    .status-bar {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      font-size: 18px;
      position: fixed;
      top: 10px;
      width: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      color: white;
    }

    .status-bar span {
      margin: 0 10px;
    }
  </style>
</head>
<body>
  <div class="status-bar">
    <span id="levelDisplay">Level: 1</span>
    <span id="scoreDisplay">Score: 0</span>
    <span id="healthDisplay">Health: 100</span>
  </div>

  <canvas id="gameCanvas"></canvas>

  <div class="controls">
    <button id="moveUp">‚¨ÜÔ∏è</button>
  </div>
  <div class="controls">
    <button id="moveLeft">‚¨ÖÔ∏è</button>
    <button id="moveDown">‚¨áÔ∏è</button>
    <button id="moveRight">‚û°Ô∏è</button>
    <div class="shoot-btn" id="shootButton">üî•</div>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    canvas.width = window.innerWidth - 20;
    canvas.height = window.innerHeight - 150;

    const tileSize = 40;
    let level = 0;
    let score = 0;

    const levels = [
             // level 1
             [
        "WWWWWWWWWWWWWWWWWWWW",
        "W     W            W",
        "W W W W WWWWWWWW W W",
        "W W W W          W W",
        "W W W W WWWWWWWW W W",
        "W W W            W W",
        "W   W W WWWWWWWW   W",
        "WWWWWWWW          W W",
        "W               W W W",
        "W WWWWWWWWWWWWWWW W W",
        "W W                ",
        "W W  WWWWWWWWWWWWW  ",
        "W                 W E",
        "WWWWWWWWWWWWWWWWWWW",
      ],
      // level 2
      [
        "WWWWWWWWWWWWWWWWWWWW",
        "W  WE               W",
        "W WWWWWWWWWWWWWWW  W",
        "W W              W W",
        "W W WWWWWWWWWWW  W W",
        "W W W        W   W W",
        "W W W WWWWW  WWWWW W",
        "W W W              W",
        "W WWWWWWWWWWWW WWWWW",
        "W                   W",
        "WWWWWWWWWWWWWWWWWWWWW",
      ],
      // level 3 
      [
        "WWWWWWWWWWWWWWWWWWWW",
        "W   W            E W",
        "W W W WWWWWWWWWW W W",
        "W W W W          W W",
        "W W   W WWWWWWWW W W",
        "W   W W          W W",
        "WWWWWWWW WWWWWWWWWWW",
        "W                  W",
        "W WWWWWWWWWWWWWWW  W",
        "W W              W W",
        "W W WWWWWWWWWWWWW W ",
        "W W               W W",
        "WWWWWWWWWWWWWWWWWWWW",
      ],
      // level 4
      [
        "WWWWWWWWWWWWWWWWWWWW",
        "W                  W",
        "W WWWWWWWWWWWWWWWW W",
        "W W              W W",
        "W W WWWWWWWWWWW  W W",
        "W W W          W W W",
        "W W W WWWWWWW  W W W",
        "W   W          W W W",
        "W WWWWWWWWWWWWWW W W",
        "W           WE   W W",
        "WWWWWWWWWWWWWWWWWWWW",
      ],
      // level 5
      [
        "WWWWWWWWWWWWWWWWWWWW",
        "W   W     W       EW",
        "W W W W W W WWWWWWWW",
        "W W W W W W W       ",
        "W W W W W W W WWWWWWW",
        "W W W W            W",
        "W W W W WWWWWWWWWWWWW",
        "W W W W             W",
        "W W WWWWWWWWWWWW  W W",
        "W W              W W ",
        "W WWWWWWWWWWWWWWWW W ",
        "W        H        W W",
        "WWWWWWWWWWWWWWWWWWWW ",
       ],
       // level 6
       [
        "WWWWWWWWWWWWWWWWWWWW",
        "W                  W",
        "W W WWWWWWWWWWWWWW W",
        "W W W            W W",
        "W W W WWWWWWWWWW W W",
        "W W W          W W W",
        "W W W WWWWWWWWWW W W",
        "W W              W W",
        "W WWWWWWWW WWWWWWWWW",
        "W       WE         W",
        "WWWWWWWWWWWWWWWWWWWW",
      ],
      // level 7
      [
        "WWWWWWWWWWWWWWWWWWWW",
        "W W W            E W",
        "W W W WWWWWWWWWW W W",
        "W W W W          W W",
        "W W W  W WWWWWWWW W W",
        "W   W W          W W",
        "WW  WWWWW WWWWWWWWWWW",
        "W                  W",
        "W WWWWWWWWWWWWWWW  W",
        "W W              W W",
        "W W WWWWWWWWWWWWW W ",
        "W W               W W",
        "WWWWWWWWWWWWWWWWWWWW",
      ],
      // level 8
      [
        "WWWWWWWWWWWWWWWWWWWW",
        "W   W   W        WEW",
        "W W W W WWWWWWWWWW  ",
        "W W W W            W",
        "W W W WWWWWWWWWWW  W",
        "W W   W          W W",
        "W WWWWWWWWWWWWWWWW W",
        "W                  W",
        "W WWWWWWWWWWWWWWW  W",
        "W W              W W",
        "W W WWWWWWWWWWWWW W ",
        "W W               W ",
        "W   W W WWWWWWWWWWW ",
        "W W   W          W W",
        "WWWWWWWWWWWWWWWWWWWW",
      ],
      // level 9
      [
        "WWWWWWWWWWWWWWWWWWWWWW",
        "W                    W",
        "W WWWWWW W WWWWWWWW WW",
        "W W    W   W        WW",
        "W W WWWWWWWW WWWWWW WW",
        "W W        W        WW",
        "W WWWWWWWWWW WWWWWW WW",
        "W W                 WW",
        "W WWWWWWWWWW WWWWWW WW",
        "W        W           W",
        "W WWWWWWWWWWWWWW WWW W",
        "W W                  W",
        "W W WWWWWWWWWW WWWWWW W",
        "W W          EW       W",
        "W WWWWWWWWWWWWWWWWWWWW",
      ],
      // level 10
      [
        "WWWWWWWWWWWWWWWWWWWW",
        "W         W       EW",
        "W WWWWWWW W WWWWWWWW",
        "W W   W   W       W ",
        "W W W WWWWWWWWWWW W ",
        "W W W           W W ",
        "W W WWWWWWWWWWW W W ",
        "W W       W     W W ",
        "W WWWWWWW W WWWWW W ",
        "W     W   W     W W ",
        "WWWW  W WWWWWWW W W ",
        "W     W         W W ",
        "W WWWWWWWWWWWWWWW W ",
        "W                  W",
        "WWWWWWWWWWWWWWWWWWWW",
    ],
    // level 11
    [
      "WWWWWWWWWWWWWWWWWWWW",
      "W                  W",
      "W W W W W WWWWWWWW W",
      "W W W W W          W",
      "W W W W W WWWWWWWW W",
      "W W   W            W",
      "W WWWWWWWW WWWWWWW W",
      "W                  W",
      "W WWWWWWWWWWWWWWWWW ",
      "W                 EW",
      "WWWWWWWWWWWWWWWWWWWW",
    ],
    // level 12
    [
      "WWWWWWWWWWWWWWWWWWWW",
      "W     W            W",
      "W W W W WWWWWWWW W W",
      "W W W W          W W",
      "W W W W WWWWWWWW W W",
      "W W W            W W",
      "W   W W WWWWWWWW   W",
      "WWWWWWWW          W W",
      "W               W W W",
      "W WWWWWWWWWWWWWWW W W",
      "W W                W ",
      "W W  WWWWWWWWWWWWWWW ",
      "W                   E",
      "WWWWWWWWWWWWWWWWWWWWW",
    ],
    // level 13
    [
      "WWWWWWWWWWWWWWWWWWWW",
      "W                  W",
      "W WWWWWW WWWWWWWWW W",
      "W W               W W",
      "W W WWWWWWWWWWWWW W W",
      "W W               W W",
      "W WWWWWWWWWWWWWWW   W",
      "WWWWWWWW          W W",
      "W                  W W",
      "W WWWWWWWWWWWWWWWWWW W",
      "W                   W ",
      "W WWWWWWWWWWWWWWWWWWW ",
      "W                    E",
      "WWWWWWWWWWWWWWWWWWWWWW",
    ],
    // level 14 
    [
      "WWWWWWWWWWWWWWWWWWWW",
      "W  W            W  W",
      "W W W WWWWWWWWW W W ",
      "W W W        W  W W ",
      "W W WWWWWWWWWW W W W",
      "W     W        W   W",
      "WWWW W WWWWWWWWWWWWW",
      "W     W   W        W",
      "W WWWWW W WWWWWWWW W",
      "W       W        W W",
      "W WWWWWWWWWWWWWW W W",
      "W W              W W",
      "W W WWWWWWWWWWWWWWW W",
      "W                  EW",
      "WWWWWWWWWWWWWWWWWWWW"
    ],
    ];

    const player = {
      x: 1,
      y: 1,
      color: 'red',
      bullets: [],
      health: 100,
    };

    const enemies = [];

    function loadLevel(levelIndex) {
      enemies.length = 0;
      player.x = 1;
      player.y = 1;
      player.bullets = [];

      const levelMap = levels[levelIndex];
      for (let y = 0; y < levelMap.length; y++) {
        for (let x = 0; x < levelMap[y].length; x++) {
          if (Math.random() < 0.1 && levelMap[y][x] === ' ') {
            enemies.push({ x, y, direction: getRandomDirection() });
          }
        }
      }
    }

    function getRandomDirection() {
      const directions = [
        { x: 1, y: 0 }, // –≤–ø—Ä–∞–≤–æ
        { x: -1, y: 0 }, // –≤–ª–µ–≤–æ
        { x: 0, y: 1 }, // –≤–Ω–∏–∑
        { x: 0, y: -1 }, // –≤–≤–µ—Ä—Ö
      ];
      return directions[Math.floor(Math.random() * directions.length)];
    }

    function drawMaze() {
      const levelMap = levels[level];
      for (let y = 0; y < levelMap.length; y++) {
        for (let x = 0; x < levelMap[y].length; x++) {
          if (levelMap[y][x] === 'W') {
            ctx.fillStyle = 'gray';
            ctx.fillRect(x * tileSize, y * tileSize, tileSize, tileSize);
          } else if (levelMap[y][x] === 'E') {
            ctx.fillStyle = 'blue';
            ctx.fillRect(x * tileSize, y * tileSize, tileSize, tileSize);
          }
        }
      }
    }

    function drawPlayer() {
      ctx.fillStyle = player.color;
      ctx.fillRect(player.x * tileSize, player.y * tileSize, tileSize, tileSize);
    }

    function drawBullets() {
      player.bullets.forEach(bullet => {
        ctx.fillStyle = 'yellow';
        ctx.beginPath();
        ctx.arc(bullet.x, bullet.y, 5, 0, Math.PI * 2);
        ctx.fill();
      });
    }

    function drawEnemies() {
      enemies.forEach(enemy => {
        ctx.fillStyle = 'green';
        ctx.fillRect(enemy.x * tileSize, enemy.y * tileSize, tileSize, tileSize);
      });
    }

    function movePlayer(dx, dy) {
      const newX = player.x + dx;
      const newY = player.y + dy;

      if (levels[level][newY]?.[newX] !== 'W') {
        player.x = newX;
        player.y = newY;

        if (levels[level][newY]?.[newX] === 'E') {
          level++;
          if (level < levels.length) {
            loadLevel(level);
          } else {
            alert('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, –≤—ã –ø—Ä–æ—à–ª–∏ –≤—Å–µ —É—Ä–æ–≤–Ω–∏!');
            document.location.reload();
          }
        }
      }
    }

    function moveBullets() {
      player.bullets.forEach((bullet, index) => {
        bullet.x += bullet.direction.x * bullet.speed;
        bullet.y += bullet.direction.y * bullet.speed;

        if (
          bullet.x < 0 || bullet.x > canvas.width ||
          bullet.y < 0 || bullet.y > canvas.height
        ) {
          player.bullets.splice(index, 1);
        }
      });
    }

    function checkCollisions() {
      player.bullets.forEach((bullet, bulletIndex) => {
        enemies.forEach((enemy, enemyIndex) => {
          const bulletGridX = Math.floor(bullet.x / tileSize);
          const bulletGridY = Math.floor(bullet.y / tileSize);

          if (bulletGridX === enemy.x && bulletGridY === enemy.y) {
            enemies.splice(enemyIndex, 1);
            player.bullets.splice(bulletIndex, 1);
            score += 10;
          }
        });
      });
    }

    function shootBullets() {
      const directions = [
        { x: 1, y: 0 },
        { x: -1, y: 0 },
        { x: 0, y: 1 },
        { x: 0, y: -1 },
      ];

      directions.forEach(direction => {
        player.bullets.push({
          x: player.x * tileSize + tileSize / 2,
          y: player.y * tileSize + tileSize / 2,
          direction,
          speed: 5,
        });
      });
    }

    function updateStatus() {
      document.getElementById('levelDisplay').textContent = `Level: ${level + 1}`;
      document.getElementById('scoreDisplay').textContent = `Score: ${score}`;
      document.getElementById('healthDisplay').textContent = `Health: ${player.health}`;
    }

    function moveEnemies() {
  enemies.forEach(enemy => {
    // –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –≤—Ä–∞–≥ "–∑–∞–≤–∏—Å–Ω–µ—Ç"
    const shouldFreeze = Math.random() < 0.3; // 30% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å–∞–Ω–∏—è

    if (shouldFreeze) {
      return; // –í—Ä–∞–≥ –Ω–µ –¥–≤–∏–∂–µ—Ç—Å—è
    }

    // –ï—Å–ª–∏ –≤—Ä–∞–≥ –≥–æ—Ç–æ–≤ –¥–≤–∏–≥–∞—Ç—å—Å—è, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    if (!enemy.isMoving) {
      enemy.direction = getRandomDirection(); // –ü–æ–ª—É—á–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
      enemy.isMoving = true;
    }

    // –î–≤–∏–≥–∞–µ–º –≤—Ä–∞–≥–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
    setTimeout(() => {
      const newX = enemy.x + enemy.direction.x;
      const newY = enemy.y + enemy.direction.y;

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –¥–≤–∏–≥–∞—Ç—å—Å—è –≤ –Ω–æ–≤–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
      if (levels[level][newY]?.[newX] !== 'W') {
        enemy.x = newX;
        enemy.y = newY;
      } else {
        // –ï—Å–ª–∏ –≤—Ä–∞–≥ —Å—Ç–∞–ª–∫–∏–≤–∞–µ—Ç—Å—è —Å –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ–º, –º–µ–Ω—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        enemy.direction = getRandomDirection();
      }

      enemy.isMoving = false; // –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –¥–≤–∏–∂–µ–Ω–∏—é
    }, Math.random() * 3000 + 2000); // –ó–∞–¥–µ—Ä–∂–∫–∞ –æ—Ç 2 –¥–æ 5 —Å–µ–∫—É–Ω–¥
  });
}

    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      drawMaze();
      drawPlayer();
      drawEnemies();
      drawBullets();

      moveBullets();
      moveEnemies();
      checkCollisions();
      updateStatus();

      requestAnimationFrame(gameLoop);
    }

    // –°–µ–Ω—Å–æ—Ä–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    document.getElementById('moveUp').addEventListener('click', () => movePlayer(0, -1));
    document.getElementById('moveDown').addEventListener('click', () => movePlayer(0, 1));
    document.getElementById('moveLeft').addEventListener('click', () => movePlayer(-1, 0));
    document.getElementById('moveRight').addEventListener('click', () => movePlayer(1, 0));
    document.getElementById('shootButton').addEventListener('click', shootBullets);

    loadLevel(level);
    gameLoop();
  </script>
</body>
</html>